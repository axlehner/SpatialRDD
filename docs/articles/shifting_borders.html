<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SpatialRDD">
<title>Shifting Borders, Creating Polygons from Lines • SpatialRDD</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Shifting Borders, Creating Polygons from Lines">
<meta property="og:description" content="SpatialRDD">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SpatialRDD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/shifting_borders.html">Shifting Borders, Creating Polygons from Lines</a>
    <a class="dropdown-item" href="../articles/spatialrdd_vignette.html">SpatialRDD: get started</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Shifting Borders, Creating Polygons from Lines</h1>
            
      
      
      <div class="d-none name"><code>shifting_borders.Rmd</code></div>
    </div>

    
    
<p>One of the most tedious tasks when it comes to geographic RDDs is the execution of so-called placebo checks. With these one has to show that the postulated effect disappears when the RD cutoff is shifted around. In other words, the “treated dummy” has to be insignificant when the RD estimation is carried out on any other border. Already the shifting around of the border would be very cumbersome when it is carried out in a GIS API such as QGIS or ArcGIS. Here in R, thanks to the <code>sf</code> package and its simple features, this is not that much of a problem as we saw in the main vignette of <code>SpatialRDD</code> already. Even though it is not as straightforward as it sounds because shifting a cutoff by a certain distance up or down and left or right is not quite enough most of the time as borders are never straight lines. Thus we tipically also need a shrinkage or enlargement and quite often also a transformation to change the “angle”. Furthermore we need to determine which dots on the map are the newly treated ones after we moved our cutoff. And this is where it gets tricky. Simple distance calculations to the border do not help because they don’t tell us on which side of the cutoff a point is. Since borders are never straight lines and always have odd shapes we also cannot just come up with a rule based on x- and y-coordinates. And even if we could it would be very tedious to figure out after every shift which were the exact positions in space below/above the units count as treated. Thus the only generalizeable solution left is to come up with a polygon shape that covers the “placebo treated” area. This is where the <code>SpatialRDD</code> package comes in with a very generic solution that allows to carry out a myriad of such placebochecks without having to worry about details.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://axlehner.github.io/SpatialRDD/">SpatialRDD</a></span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cut_off.sf</span>, <span class="va">polygon_full.sf</span>, <span class="va">polygon_treated.sf</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mtennekes/tmap" class="external-link">tmap</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1088</span><span class="op">)</span> <span class="co"># set a seed to make the results replicable</span>
<span class="va">points_samp.sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></span><span class="op">(</span><span class="va">polygon_full.sf</span>, <span class="fl">1000</span><span class="op">)</span>
<span class="va">points_samp.sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="va">points_samp.sf</span><span class="op">)</span> <span class="co"># make it an sf object bc st_sample only created the geometry list-column (sfc)</span>
<span class="va">points_samp.sf</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">points_samp.sf</span><span class="op">)</span> <span class="co"># add a unique ID to each observation</span></code></pre></div>
<div class="section level2">
<h2 id="more-on-placebo-bordering">More on placebo bordering<a class="anchor" aria-label="anchor" href="#more-on-placebo-bordering"></a>
</h2>
<p>When the border is not approximating a line in space but is curving and bending (i.e. in most cases), “placebo bordering” can be tricky and is not straightforward. The simple substraction/addition of a specified distance from the <code>distance2cutoff</code> variable is also not a very accurate description of placebo boundary. On top of that with such a simple transformation of the distance column we can at best do a placebo check on the “pooled” polynomial specification as the border segments change and thus the assignment of categories for fixed effects. A placebo GRD design with an iteration over the boundarypoints is literally impossible in such a case.<br>
For a proper robustness check we thus have to create a new cut-off from which we then can extract the corresponding borderpoints (with <code><a href="../reference/discretise_border.html">discretise_border()</a></code>) and also assign the border segment categories for fixed effects estimations (with <code><a href="../reference/border_segment.html">border_segment()</a></code>).<br>
The <code><a href="../reference/shift_border.html">shift_border()</a></code> function can execute three different (affine) transformations at the same time:</p>
<ul>
<li>
<code>"shift"</code> in units of CRS along the x- &amp; y-axis (provided with the option <code>shift = c(dist1, dist2)</code>)</li>
<li>
<code>"scale"</code> in percent around the centroid, where <code>0.9</code> would mean 90%</li>
<li>
<code>"rotate"</code> in degrees around the centroid with the standard rotation matrix <span class="math display">\[
rotation =
\begin{bmatrix}
\cos \theta &amp; -\sin \theta \\  
\sin \theta &amp; \cos \theta \\
\end{bmatrix}
\]</span>
</li>
</ul>
<div class="section level3">
<h3 id="rotate">Rotate<a class="anchor" aria-label="anchor" href="#rotate"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">tm_rotate.sf10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"rotate"</span>, angle <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="va">tm_rotate.sf25</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"rotate"</span>, angle <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="va">tm_rotate.sf45</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"rotate"</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>

<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon_full.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">cut_off.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_rotate.sf10</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_rotate.sf25</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_rotate.sf45</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="shifting_borders_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="scale">Scale<a class="anchor" aria-label="anchor" href="#scale"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">tm_scale.sf.4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"scale"</span>, scale <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="va">tm_scale.sf.7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"scale"</span>, scale <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="va">tm_scale.sf1.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"scale"</span>, scale <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>

<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon_full.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">cut_off.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_scale.sf.4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_scale.sf.7</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_scale.sf1.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="shifting_borders_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="shift">Shift<a class="anchor" aria-label="anchor" href="#shift"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">tm_shift.sf3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"shift"</span>, shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3000</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="va">tm_shift.sf6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"shift"</span>, shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6000</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="va">tm_shift.sf_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"shift"</span>, shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4000</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>


<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon_full.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">cut_off.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_shift.sf3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_shift.sf6</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_shift.sf_4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>  


<span class="va">tm_shift.sf_42</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"shift"</span>, shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4000</span>, <span class="op">-</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="va">tm_shift.sf_44</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="st">"shift"</span>, shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4000</span>, <span class="op">-</span><span class="fl">4000</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>

<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon_full.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">cut_off.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_shift.sf_42</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_shift.sf_44</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_shift.sf_4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>  </code></pre></div>
<p><img src="shifting_borders_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="shifting_borders_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<p>From the last shifted line we can already see that a movement along the x-axis quite often requires also a correction on the y-axis for the cut-off movement to be meaningful. This is going to be explored in detail in the following section together with all the other operations.</p>
</div>
<div class="section level3">
<h3 id="full-fledged-placebo-bordering">Full fledged “placebo bordering”<a class="anchor" aria-label="anchor" href="#full-fledged-placebo-bordering"></a>
</h3>
<p>A proper placebo border ideally involves both a shift and a re-scaling for it to be meaningful.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">tm_placebo.sf1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shift"</span>, <span class="st">"scale"</span><span class="op">)</span>, shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5000</span>, <span class="op">-</span><span class="fl">3000</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">.85</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="va">tm_placebo.sf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shift"</span>, <span class="st">"scale"</span><span class="op">)</span>, shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4000</span>, <span class="fl">2000</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="va">tm_placebo.sf3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shift"</span>, <span class="st">"scale"</span><span class="op">)</span>, shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6000</span>, <span class="fl">3000</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon_full.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">cut_off.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_placebo.sf1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_placebo.sf2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_placebo.sf3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="shifting_borders_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">tm_shift.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shift_border.html">shift_border</a></span><span class="op">(</span>border <span class="op">=</span> <span class="va">cut_off.sf</span>, operation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shift"</span>, <span class="st">"rotate"</span>, <span class="st">"scale"</span><span class="op">)</span>, 
                              shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10000</span>, <span class="op">-</span><span class="fl">1000</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">0</span>, scale <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span>
<span class="co">#&gt; Pay attention to CRS! If you work in lon/lat then degrees have to be provided. Local UTM CRS is preferable!</span>
<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">cut_off.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">tm_shift.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="shifting_borders_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<p>And the according polygons to assign the treated dummies:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">polygon1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cutoff2polygon.html">cutoff2polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">points_samp.sf</span>, cutoff <span class="op">=</span> <span class="va">tm_placebo.sf1</span>, orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"west"</span>, <span class="st">"west"</span><span class="op">)</span>, endpoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.2</span><span class="op">)</span>, <span class="co"># corners = 0,</span>
                           <span class="co">#     crs = 32643</span>
                           <span class="op">)</span>
<span class="va">polygon2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cutoff2polygon.html">cutoff2polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">points_samp.sf</span>, cutoff <span class="op">=</span> <span class="va">tm_placebo.sf2</span>, orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"west"</span>, <span class="st">"west"</span><span class="op">)</span>, endpoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.2</span><span class="op">)</span>, <span class="co"># corners = 0,</span>
                           <span class="co">#     crs = 32643</span>
                           <span class="op">)</span>
<span class="va">polygon3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cutoff2polygon.html">cutoff2polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">points_samp.sf</span>, cutoff <span class="op">=</span> <span class="va">tm_placebo.sf3</span>, orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"west"</span>, <span class="st">"west"</span><span class="op">)</span>, endpoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.2</span><span class="op">)</span>, <span class="co"># corners = 0,</span>
                           <span class="co">#     crs = 32643</span>
                           <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon_full.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon_treated.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">cut_off.sf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_lines.html" class="external-link">tm_lines</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_shape.html" class="external-link">tm_shape</a></span><span class="op">(</span><span class="va">polygon3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tmap/man/tm_polygons.html" class="external-link">tm_polygons</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span> </code></pre></div>
<p><img src="shifting_borders_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alexander Lehner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
